(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\entities\\enemy.js":[function(require,module,exports){
var Enemy = function (game, x, y) {

    Phaser.Sprite.call(this, game, x, y, 'enemySprite');
		game.add.existing(this);
		this.animations.add('run');
		this.animations.play('run', 25, true);

		this.hitPoints = 1;
		this.width = 55;
		this.height = 55;

		this.healthBar = new Phaser.Rectangle(this.x, this.y, 30, 5);
		//game.debug.geom(this.healthBar,'#ff6600');
};

Enemy.prototype = Object.create(Phaser.Sprite.prototype);
Enemy.prototype.constructor = Enemy;

/**
 * Automatically called by World.update
 */
Enemy.prototype.update = function() {
	this.move();

	if(this.hitPoints < 5) {
		this.healthBar.x = this.x + this.width / 2 - 15;
		this.healthBar.y = this.y;
		this.healthBar.width = this.hitPoints * (30 / 5);
		this.game.debug.geom(this.healthBar,'#D71E1E');
	}
	
};

Enemy.prototype.move = function() {
	this.y += 1.7;
};

Enemy.prototype.hit = function() {
	this.hitPoints -= 1;
	this.bloodSpread();
};

Enemy.prototype.bloodSpread = function() {
	//console.log('SPLÃ„TS');

};

module.exports = Enemy;

},{}],"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(1024, 768, Phaser.AUTO, 'naapurinkauhu-game');

window.Utils = require('./utils');
window.playerState = {
    currentLevel: 'Game'
}

game.state.add('Boot', require('./states/boot'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('GameOver', require('./states/gameover'));
game.state.add('Game', require('./states/game'));

game.state.start('Boot');

},{"./states/boot":"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\boot.js","./states/game":"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\game.js","./states/gameover":"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\gameover.js","./states/menu":"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\menu.js","./states/preloader":"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\preloader.js","./utils":"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\utils.js"}],"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\boot.js":[function(require,module,exports){
var Boot = function () {};

module.exports = Boot;

Boot.prototype = {

  preload: function () {
    this.load.image('preloader', 'assets/preloader.gif');
  },

  create: function () {
    //this.game.input.maxPointers = 1;

    this.input.maxPointers = 1;
    this.stage.disableVisibilityChange = true;

    if (this.game.device.desktop)
    {
        this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
        this.scale.minWidth = 480;
        this.scale.minHeight = 260;
        this.scale.maxWidth = 1024;
        this.scale.maxHeight = 768;
        this.scale.forceLandscape = true;
        this.scale.pageAlignHorizontally = true;
        this.scale.windowConstraints.bottom = "visual";
    }
    else
    {
        this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
        this.scale.setMinMax(480, 260, 1024, 768);
        this.scale.pageAlignHorizontally = true;
        this.scale.pageAlignVertically = true;
        this.scale.forceOrientation(true, false);
        this.scale.setResizeCallback(this.gameResized, this);
        this.scale.enterIncorrectOrientation.add(this.enterIncorrectOrientation, this);
        this.scale.leaveIncorrectOrientation.add(this.leaveIncorrectOrientation, this);
        this.scale.windowConstraints.bottom = "visual";
        this.scale.refresh();
    }

    this.game.state.start('Preloader');
  },

    gameResized: function (width, height) {

        //  This could be handy if you need to do any extra processing if the game resizes.
        //  A resize could happen if for example swapping orientation on a device or resizing the browser window.
        //  Note that this callback is only really useful if you use a ScaleMode of RESIZE and place it inside your main game state.

    },

    enterIncorrectOrientation: function () {

        BasicGame.orientated = false;

        document.getElementById('orientation').style.display = 'block';

    },

    leaveIncorrectOrientation: function () {

        BasicGame.orientated = true;

        document.getElementById('orientation').style.display = 'none';

    }
};

},{}],"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\game.js":[function(require,module,exports){
var Enemy = require('../entities/enemy');

var Game = function () {
  this.testentity = null;
};

module.exports = Game;

Game.prototype = {

  create: function () {
    //this.grassTileSprite = this.game.add.tileSprite(0, 0, this.game.width, this.game.height, 'dark_grass');
    //this.sandTilesprite = this.game.add.tileSprite(0, this.game.height - 128, this.game.width, 128, 'earth');

    this.levels = [{id:"Level 1", length:2, speed:2000} , {id:"Level 2", length:5, speed:1500} , {id:"Level 3", length:10, speed:1000} , {id:"Level 4", length:15, speed:300} , {id:"Level 5", length:30, speed:50}, {id:"Level 6", length:40, speed:10}];
    this.levelIndex = 0;
    this.levelLoading = true;

    this.backGround = this.game.add.sprite(0,0, 'bg');

    this.game.time.advancedTiming = true;

    this.enemysSoldiers = [];
    this.soldiers = [];
    this.enemySoldiersCount = 10;
    this.soldiersCount = 10;
    this.gameover = false;
    this.game.enemyKilled = 0;

    this.soldiersLeftText = this.add.bitmapText(0, 60, 'minecraftia', this.soldiersCount.toString() );
    this.soldiersLeftText.x = this.game.width - this.soldiersLeftText.textWidth - 20;

    this.currentLevelText = this.add.bitmapText(0, 20, 'minecraftia', this.currentLevel().id );
    this.currentLevelText.x = this.game.width - this.currentLevelText.textWidth - 20;

    // Bullets
    this.fireRate = 50;
    this.nextFire = 10;

    this.bullets = this.game.add.group();
    this.bullets.enableBody = true;
    this.bullets.physicsBodyType = Phaser.Physics.ARCADE;

    this.bullets.createMultiple(100, 'bullet');
    this.bullets.setAll('checkWorldBounds', true);
    this.bullets.setAll('outOfBoundsKill', true);

    //this.turretHolder = this.game.add.sprite(this.game.width / 2, this.game.height - 75, 'turretholder');
    
    this.sprite = this.game.add.sprite(this.game.width / 2 - 20, this.game.height - 75, 'turret');
    this.sprite.scale.set(0.25,0.25);
    this.sprite.anchor.set(0, 0.5);
    this.sprite.visible = false;

    this.game.physics.enable(this.sprite, Phaser.Physics.ARCADE);
    this.sprite.body.allowRotation = false;

    this.enemyTimer = this.game.time.create(false);
    this.enemyTimer.loop(this.currentLevel().speed, this.createEnemy, this);
    this.enemyTimer.start();

    // Enemy animations 
    this.enemyDyingAnimations = this.game.add.group();

    for (var i = 0; i < 30; i++)
    {
        var enemyDyingAnimation = this.enemyDyingAnimations.create(0, 0, 'enemydying', [0], false);
        enemyDyingAnimation.anchor.setTo(0, -0.25);
        enemyDyingAnimation.animations.add('enemydying');
    }

    // concentratedFire
    this.explosions = this.game.add.group();
    //this.explosions.enableBody = true;
    //this.explosions.physicsBodyType = Phaser.Physics.ARCADE;
    for (var j = 0; j < 10; j++)
    {
        var explosionAnimation = this.explosions.create(0, 0, 'smallExplosion', [0], false);
        explosionAnimation.anchor.setTo(0.5, 0.5);
        explosionAnimation.animations.add('smallExplosion');
    }

    //this.concentratedFireButton = this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);

    //this.emitter = this.game.add.emitter(0, 0, 100);
    //this.emitter.particleFriction = 0.1;

  },

  update: function () {

    this.game.debug.text(this.game.time.fps || '--', 2, 14, '#00ff00');

    if(this.gameover) {
      return;
    }

    /*if(this.enemysSoldiers.length < this.enemySoldiersCount){
      this.createEnemy();
    }*/

    if(!this.enemysSoldiers) {
      return;
    }

    for (var i = this.enemysSoldiers.length - 1; i >= 0; i--) {
      var enemy = this.enemysSoldiers[i];

      this.game.physics.arcade.overlap(this.bullets, this.enemysSoldiers[i], this.bulletHitEnemy, null, this);
      
      if(enemy.y >= this.game.height - 150) {
        this.soldiersCount -= 1;
        
        this.enemysSoldiers.splice(i,1);
        this.soldiersLeftText.setText(this.soldiersCount.toString());

        var explosiong = this.explosions.getFirstExists(false);
        explosiong.reset(enemy.x, enemy.y);
        explosiong.play('smallExplosion', 30, false, false);

        enemy.destroy();

        if(this.soldiersCount <= 0){
          this.game.state.start('GameOver');
        }
      }

    }

    this.sprite.rotation = this.game.physics.arcade.angleToPointer(this.sprite);
    if (this.game.input.activePointer.isDown) {
      this.sprite.visible = true;
      this.fire();
    } else {
       this.sprite.visible = false;
    }

    /*if (this.concentratedFireButton.isDown) {
       this.concentratedFire(this.game.input.activePointer.x - 100,this.game.input.activePointer.y - 100);
    }*/

  },

  fire: function () {
    if (this.game.time.now > this.nextFire && this.bullets.countDead() > 0)
    {
      this.nextFire = this.game.time.now + this.fireRate;
      var bullet = this.bullets.getFirstDead();
      bullet.reset(this.sprite.x - 2, this.sprite.y - 5);
      bullet.rotation = this.game.physics.arcade.moveToPointer(bullet, 1500, this.game.input.activePointer);
    }
  },

  currentLevel: function () {
    return this.levels[this.levelIndex];
  },

  nextLevel: function () {
    this.levelIndex++;

    if(this.currentLevel()) {
      
      //this.enemyTimer.delay = this.currentLevel().speed;
      this.enemyTimer.destroy();
      this.enemyTimer = this.game.time.create(false);
      this.enemyTimer.loop(this.currentLevel().speed, this.createEnemy, this);
      this.enemyTimer.start();


      this.currentLevelText.destroy();
      this.currentLevelText = this.add.bitmapText(0, 20, 'minecraftia', this.currentLevel().id );
      this.currentLevelText.x = this.game.width - this.currentLevelText.textWidth - 20;


    } else {
      this.game.state.start('GameOver');
    }    
  },

  concentratedFire: function (x,y) {
        for (var i = this.explosions.length - 1; i >= 0; i--) {
          var explosionsAnimation = this.explosions.getAt(i);
          explosionsAnimation.reset(x + Math.random()*200, y + Math.random()*200);
          explosionsAnimation.play('smallExplosion', 30, false, true);
        }

        for (var j = this.enemysSoldiers.length - 1; j >= 0; j--) {
          var enemy = this.enemysSoldiers[j];
           this.game.physics.arcade.overlap(this.explosions, enemy, this.hitEnemy, null, this);
          
        }
  },

  bulletHitEnemy: function (enemy, bullet) {

      /*this.emitter.makeParticles('blood');
      var blood = new Phaser.Rectangle(0, 0, 30, 5);
      this.emitter.makeParticles(blood);

      this.emitter.rotation = bullet.rotation;

      this.emitter.gravity = 0;
      this.emitter.maxRotation = 0;
      this.emitter.minRotation = 0;

      this.emitter.setAlpha(1, 0, 600);

      var p1 = new Phaser.Point (1,0);
      p1.rotate(0,0,bullet.rotation + 0.5);
      p1.setMagnitude(200);
      
      var p2 = new Phaser.Point (1,0);
      p2.rotate(0,0,bullet.rotation - 0.5);
      p2.setMagnitude(200);

      this.emitter.maxParticleSpeed = p1;
      this.emitter.minParticleSpeed = p2;
      //this.emitter.rotation = 0;
      this.emitter.x = enemy.x + 30;
      this.emitter.y = enemy.y + 35;

      this.emitter.start(true, 600, null, 10);*/
      bullet.kill();

      for (var i = this.enemysSoldiers.length - 1; i >= 0; i--) {
        if(enemy === this.enemysSoldiers[i])
        {
          enemy.hit();

          if(enemy.hitPoints === 0) {
            this.enemysSoldiers.splice(i,1);

            var enemyDyingAnimation = this.enemyDyingAnimations.getFirstExists(false);
            enemyDyingAnimation.reset(enemy.x, enemy.y);
            enemyDyingAnimation.alpha = 1;
            enemyDyingAnimation.play('enemydying', 30, false, false);
            this.game.time.events.add(Phaser.Timer.SECOND * 1, this.fadeAnimation, this, enemyDyingAnimation);
          }
        }
      }
      
      if(enemy.hitPoints === 0) {
        enemy.kill();
        this.game.enemyKilled++;

        if(this.game.enemyKilled >= this.currentLevel().length){
          this.nextLevel();
        }
      }

      //var destroyed = enemies[tank.name].damage();

      /*if (destroyed)
      {
          var explosionAnimation = explosions.getFirstExists(false);
          explosionAnimation.reset(tank.x, tank.y);
          explosionAnimation.play('kaboom', 30, false, true);
      }*/
  },

  fadeAnimation: function (animation) {
    //console.log("-----");
    //console.log(animation);
    var fadeAnim = this.game.add.tween(animation).to( { alpha: 0 }, 1000, Phaser.Easing.Linear.None, true);
    fadeAnim.onComplete.add(function () { this.removeTween(animation); }, this);

  },

  hitEnemy: function (enemy) {
    for (var i = this.enemysSoldiers.length - 1; i >= 0; i--) {
      if(enemy === this.enemysSoldiers[i])
      {
        this.enemysSoldiers.splice(i,1);

        var enemyDyingAnimation = this.enemyDyingAnimations.getFirstExists(false);
        enemyDyingAnimation.reset(enemy.x, enemy.y);
        enemyDyingAnimation.play('enemydying', 30, false, false);
      }
    }
    enemy.kill();
  },

  removeTween: function (animation) {
    animation.kill();
  },
  killAnimation: function (animation) {
    //console.log("this.enemyDyingAnimations");
    //console.log(this.enemyDyingAnimations);
  },

  checkOverlapEnemyX: function () {
    
    

  },

  createEnemy: function () {

    var enemyX = Math.floor(Math.random() * (this.game.width - 65));

    /*var pass = true;
    for (var i = this.enemysSoldiers.length - 1; i >= 0; i--) {
      var soldier = this.enemysSoldiers[i];

      if(enemyX < soldier.x + 65 && enemyX > soldier.x - 65 ) {
        pass = false;
      }

    }*/

    /*if(!pass){
      this.createEnemy();
      return;
    }*/

    var enemy = new Enemy(this.game, enemyX, 0);
    this.game.physics.enable(enemy, Phaser.Physics.ARCADE);
    this.enemysSoldiers.push(enemy);
    
  },

  checkOverlap: function (spriteA, spriteB) {
    var boundsA = spriteA.getBounds();
    var boundsB = spriteB.getBounds();

    return Phaser.Rectangle.intersects(boundsA, boundsB);
  },

  endGame: function () {
    
  },

  onInputDown: function () {
    this.game.state.start('Menu');
  }
};

},{"../entities/enemy":"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\entities\\enemy.js"}],"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\gameover.js":[function(require,module,exports){
var Gameover = function () {};

module.exports = Gameover;

Gameover.prototype = {

  create: function () {
    var x = this.game.width / 2
      , y = this.game.height / 2;

    this.titleTxt = this.add.bitmapText(x, y, 'minecraftia', 'Killed: ' + this.game.enemyKilled );
    this.titleTxt.align = 'center';
    this.titleTxt.x = this.game.width / 2 - this.titleTxt.textWidth / 2;

    //y = y + this.titleTxt.height + 5;
    this.startTxt = this.add.bitmapText(x, y + 50, 'minecraftia', 'GAME OVER');
    this.startTxt.align = 'center';
    this.startTxt.x = this.game.width / 2 - this.startTxt.textWidth / 2;
    
    this.input.onDown.add(this.onDown, this);
  },

  update: function () {

  },

  onDown: function () {
    this.game.state.start('Menu');
    //this.game.state.start('Gameover');
  }
};

},{}],"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\menu.js":[function(require,module,exports){
var Menu = function () {
  this.text = null;
};

module.exports = Menu;

Menu.prototype = {

  create: function () {
    var x = this.game.width / 2
      , y = this.game.height / 2;

    
    this.logoText = this.add.bitmapText(x, y - 200, 'minecraftia', 'LSG', 164 );
    this.logoText.align = 'center';
    this.logoText.x = this.game.width / 2 - this.logoText.textWidth / 2;

    this.desciptionTxt = this.add.bitmapText(x, y + 10, 'minecraftia', 'LITTLE SHITTY GAMES', 27 );
    this.desciptionTxt.align = 'center';
    this.desciptionTxt.x = this.game.width / 2 - this.desciptionTxt.textWidth / 2;

    this.titleTxt = this.add.bitmapText(x, y + 100, 'minecraftia', 'Naapurinkauhu' );
    this.titleTxt.align = 'center';
    this.titleTxt.x = this.game.width / 2 - this.titleTxt.textWidth / 2;

    this.startTxt = this.add.bitmapText(x, this.game.height - this.titleTxt.height - 15, 'minecraftia', 'Press screen to start');
    this.startTxt.align = 'center';
    this.startTxt.x = this.game.width / 2 - this.startTxt.textWidth / 2;

    this.input.onDown.add(this.onDown, this);
  },

  update: function () {

  },

  onDown: function () {
    this.game.state.start('Game');
    //this.game.scale.startFullScreen();
  }
};

},{}],"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\states\\preloader.js":[function(require,module,exports){
var Preloader = function (game) {
  this.asset = null;
  this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

  preload: function () {
      this.asset = this.add.sprite(this.game.width / 2, this.game.height / 2, 'preloader');
      this.asset.anchor.setTo(0.5, 0.5);

      this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
      this.load.setPreloadSprite(this.asset);
      this.load.spritesheet('kaboom', 'assets/explosion.png', 64, 64, 23);
      this.load.spritesheet('bigExplosion', 'assets/big-explosion.png', 256, 128, 12);
      this.load.spritesheet('smallExplosion', 'assets/small-explosion.png', 96, 96, 48);
      this.load.spritesheet('enemydying', 'assets/enemydying.png', 63, 64, 20);
      this.load.spritesheet('enemySprite', 'assets/enemy.png', 64, 64, 15);
      this.load.image('bg', 'assets/bg.png');
      this.load.image('blood', 'assets/blood.jpg');
      this.load.image('earth', 'assets/earth.png');
      this.load.image('enemy', 'assets/invader.png');
      this.load.image('turret', 'assets/turret.png');
      this.load.image('turretholder', 'assets/gun-holder.png');
      this.load.image('bullet', 'assets/bullet.png');
      this.load.bitmapFont('minecraftia', 'assets/minecraftia.png', 'assets/minecraftia.xml');
      this.load.audio('sfx', 'assets/audio/SoundEffects/fx_mixdown.ogg');
  },

  create: function () {
    this.asset.cropEnabled = false;
  },

  update: function () {
    if (!!this.ready) {
        this.game.state.start('Menu');
      }
  },

  onLoadComplete: function () {
    this.ready = true;
  }
};

},{}],"c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\utils.js":[function(require,module,exports){
var Utils = {
    containsObject: function(obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    }
};

module.exports = Utils;
},{}]},{},["c:\\Projects\\Git\\lsg-naapurin-kauhu-up\\src\\js\\main.js"])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZW50aXRpZXMvZW5lbXkuanMiLCJzcmMvanMvbWFpbi5qcyIsInNyYy9qcy9zdGF0ZXMvYm9vdC5qcyIsInNyYy9qcy9zdGF0ZXMvZ2FtZS5qcyIsInNyYy9qcy9zdGF0ZXMvZ2FtZW92ZXIuanMiLCJzcmMvanMvc3RhdGVzL21lbnUuanMiLCJzcmMvanMvc3RhdGVzL3ByZWxvYWRlci5qcyIsInNyYy9qcy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hWQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDekNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBFbmVteSA9IGZ1bmN0aW9uIChnYW1lLCB4LCB5KSB7XHJcblxyXG4gICAgUGhhc2VyLlNwcml0ZS5jYWxsKHRoaXMsIGdhbWUsIHgsIHksICdlbmVteVNwcml0ZScpO1xyXG5cdFx0Z2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XHJcblx0XHR0aGlzLmFuaW1hdGlvbnMuYWRkKCdydW4nKTtcclxuXHRcdHRoaXMuYW5pbWF0aW9ucy5wbGF5KCdydW4nLCAyNSwgdHJ1ZSk7XHJcblxyXG5cdFx0dGhpcy5oaXRQb2ludHMgPSAxO1xyXG5cdFx0dGhpcy53aWR0aCA9IDU1O1xyXG5cdFx0dGhpcy5oZWlnaHQgPSA1NTtcclxuXHJcblx0XHR0aGlzLmhlYWx0aEJhciA9IG5ldyBQaGFzZXIuUmVjdGFuZ2xlKHRoaXMueCwgdGhpcy55LCAzMCwgNSk7XHJcblx0XHQvL2dhbWUuZGVidWcuZ2VvbSh0aGlzLmhlYWx0aEJhciwnI2ZmNjYwMCcpO1xyXG59O1xyXG5cclxuRW5lbXkucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3ByaXRlLnByb3RvdHlwZSk7XHJcbkVuZW15LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IEVuZW15O1xyXG5cclxuLyoqXHJcbiAqIEF1dG9tYXRpY2FsbHkgY2FsbGVkIGJ5IFdvcmxkLnVwZGF0ZVxyXG4gKi9cclxuRW5lbXkucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMubW92ZSgpO1xyXG5cclxuXHRpZih0aGlzLmhpdFBvaW50cyA8IDUpIHtcclxuXHRcdHRoaXMuaGVhbHRoQmFyLnggPSB0aGlzLnggKyB0aGlzLndpZHRoIC8gMiAtIDE1O1xyXG5cdFx0dGhpcy5oZWFsdGhCYXIueSA9IHRoaXMueTtcclxuXHRcdHRoaXMuaGVhbHRoQmFyLndpZHRoID0gdGhpcy5oaXRQb2ludHMgKiAoMzAgLyA1KTtcclxuXHRcdHRoaXMuZ2FtZS5kZWJ1Zy5nZW9tKHRoaXMuaGVhbHRoQmFyLCcjRDcxRTFFJyk7XHJcblx0fVxyXG5cdFxyXG59O1xyXG5cclxuRW5lbXkucHJvdG90eXBlLm1vdmUgPSBmdW5jdGlvbigpIHtcclxuXHR0aGlzLnkgKz0gMS43O1xyXG59O1xyXG5cclxuRW5lbXkucHJvdG90eXBlLmhpdCA9IGZ1bmN0aW9uKCkge1xyXG5cdHRoaXMuaGl0UG9pbnRzIC09IDE7XHJcblx0dGhpcy5ibG9vZFNwcmVhZCgpO1xyXG59O1xyXG5cclxuRW5lbXkucHJvdG90eXBlLmJsb29kU3ByZWFkID0gZnVuY3Rpb24oKSB7XHJcblx0Ly9jb25zb2xlLmxvZygnU1BMw4RUUycpO1xyXG5cclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gRW5lbXk7XHJcbiIsIid1c2Ugc3RyaWN0JztcclxuXHJcbnZhciBnYW1lID0gbmV3IFBoYXNlci5HYW1lKDEwMjQsIDc2OCwgUGhhc2VyLkFVVE8sICduYWFwdXJpbmthdWh1LWdhbWUnKTtcclxuXHJcbndpbmRvdy5VdGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcclxud2luZG93LnBsYXllclN0YXRlID0ge1xyXG4gICAgY3VycmVudExldmVsOiAnR2FtZSdcclxufVxyXG5cclxuZ2FtZS5zdGF0ZS5hZGQoJ0Jvb3QnLCByZXF1aXJlKCcuL3N0YXRlcy9ib290JykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnUHJlbG9hZGVyJywgcmVxdWlyZSgnLi9zdGF0ZXMvcHJlbG9hZGVyJykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnTWVudScsIHJlcXVpcmUoJy4vc3RhdGVzL21lbnUnKSk7XHJcbmdhbWUuc3RhdGUuYWRkKCdHYW1lT3ZlcicsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWVvdmVyJykpO1xyXG5nYW1lLnN0YXRlLmFkZCgnR2FtZScsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWUnKSk7XHJcblxyXG5nYW1lLnN0YXRlLnN0YXJ0KCdCb290Jyk7XHJcbiIsInZhciBCb290ID0gZnVuY3Rpb24gKCkge307XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEJvb3Q7XHJcblxyXG5Cb290LnByb3RvdHlwZSA9IHtcclxuXHJcbiAgcHJlbG9hZDogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5sb2FkLmltYWdlKCdwcmVsb2FkZXInLCAnYXNzZXRzL3ByZWxvYWRlci5naWYnKTtcclxuICB9LFxyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vdGhpcy5nYW1lLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcclxuXHJcbiAgICB0aGlzLmlucHV0Lm1heFBvaW50ZXJzID0gMTtcclxuICAgIHRoaXMuc3RhZ2UuZGlzYWJsZVZpc2liaWxpdHlDaGFuZ2UgPSB0cnVlO1xyXG5cclxuICAgIGlmICh0aGlzLmdhbWUuZGV2aWNlLmRlc2t0b3ApXHJcbiAgICB7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xyXG4gICAgICAgIHRoaXMuc2NhbGUubWluV2lkdGggPSA0ODA7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5taW5IZWlnaHQgPSAyNjA7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5tYXhXaWR0aCA9IDEwMjQ7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5tYXhIZWlnaHQgPSA3Njg7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5mb3JjZUxhbmRzY2FwZSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2NhbGUud2luZG93Q29uc3RyYWludHMuYm90dG9tID0gXCJ2aXN1YWxcIjtcclxuICAgIH1cclxuICAgIGVsc2VcclxuICAgIHtcclxuICAgICAgICB0aGlzLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5zZXRNaW5NYXgoNDgwLCAyNjAsIDEwMjQsIDc2OCk7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5wYWdlQWxpZ25Ib3Jpem9udGFsbHkgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuc2NhbGUucGFnZUFsaWduVmVydGljYWxseSA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5zY2FsZS5mb3JjZU9yaWVudGF0aW9uKHRydWUsIGZhbHNlKTtcclxuICAgICAgICB0aGlzLnNjYWxlLnNldFJlc2l6ZUNhbGxiYWNrKHRoaXMuZ2FtZVJlc2l6ZWQsIHRoaXMpO1xyXG4gICAgICAgIHRoaXMuc2NhbGUuZW50ZXJJbmNvcnJlY3RPcmllbnRhdGlvbi5hZGQodGhpcy5lbnRlckluY29ycmVjdE9yaWVudGF0aW9uLCB0aGlzKTtcclxuICAgICAgICB0aGlzLnNjYWxlLmxlYXZlSW5jb3JyZWN0T3JpZW50YXRpb24uYWRkKHRoaXMubGVhdmVJbmNvcnJlY3RPcmllbnRhdGlvbiwgdGhpcyk7XHJcbiAgICAgICAgdGhpcy5zY2FsZS53aW5kb3dDb25zdHJhaW50cy5ib3R0b20gPSBcInZpc3VhbFwiO1xyXG4gICAgICAgIHRoaXMuc2NhbGUucmVmcmVzaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnUHJlbG9hZGVyJyk7XHJcbiAgfSxcclxuXHJcbiAgICBnYW1lUmVzaXplZDogZnVuY3Rpb24gKHdpZHRoLCBoZWlnaHQpIHtcclxuXHJcbiAgICAgICAgLy8gIFRoaXMgY291bGQgYmUgaGFuZHkgaWYgeW91IG5lZWQgdG8gZG8gYW55IGV4dHJhIHByb2Nlc3NpbmcgaWYgdGhlIGdhbWUgcmVzaXplcy5cclxuICAgICAgICAvLyAgQSByZXNpemUgY291bGQgaGFwcGVuIGlmIGZvciBleGFtcGxlIHN3YXBwaW5nIG9yaWVudGF0aW9uIG9uIGEgZGV2aWNlIG9yIHJlc2l6aW5nIHRoZSBicm93c2VyIHdpbmRvdy5cclxuICAgICAgICAvLyAgTm90ZSB0aGF0IHRoaXMgY2FsbGJhY2sgaXMgb25seSByZWFsbHkgdXNlZnVsIGlmIHlvdSB1c2UgYSBTY2FsZU1vZGUgb2YgUkVTSVpFIGFuZCBwbGFjZSBpdCBpbnNpZGUgeW91ciBtYWluIGdhbWUgc3RhdGUuXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBlbnRlckluY29ycmVjdE9yaWVudGF0aW9uOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIEJhc2ljR2FtZS5vcmllbnRhdGVkID0gZmFsc2U7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcmllbnRhdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICAgIH0sXHJcblxyXG4gICAgbGVhdmVJbmNvcnJlY3RPcmllbnRhdGlvbjogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgICBCYXNpY0dhbWUub3JpZW50YXRlZCA9IHRydWU7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvcmllbnRhdGlvbicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblxyXG4gICAgfVxyXG59O1xyXG4iLCJ2YXIgRW5lbXkgPSByZXF1aXJlKCcuLi9lbnRpdGllcy9lbmVteScpO1xyXG5cclxudmFyIEdhbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgdGhpcy50ZXN0ZW50aXR5ID0gbnVsbDtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gR2FtZTtcclxuXHJcbkdhbWUucHJvdG90eXBlID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIC8vdGhpcy5ncmFzc1RpbGVTcHJpdGUgPSB0aGlzLmdhbWUuYWRkLnRpbGVTcHJpdGUoMCwgMCwgdGhpcy5nYW1lLndpZHRoLCB0aGlzLmdhbWUuaGVpZ2h0LCAnZGFya19ncmFzcycpO1xyXG4gICAgLy90aGlzLnNhbmRUaWxlc3ByaXRlID0gdGhpcy5nYW1lLmFkZC50aWxlU3ByaXRlKDAsIHRoaXMuZ2FtZS5oZWlnaHQgLSAxMjgsIHRoaXMuZ2FtZS53aWR0aCwgMTI4LCAnZWFydGgnKTtcclxuXHJcbiAgICB0aGlzLmxldmVscyA9IFt7aWQ6XCJMZXZlbCAxXCIsIGxlbmd0aDoyLCBzcGVlZDoyMDAwfSAsIHtpZDpcIkxldmVsIDJcIiwgbGVuZ3RoOjUsIHNwZWVkOjE1MDB9ICwge2lkOlwiTGV2ZWwgM1wiLCBsZW5ndGg6MTAsIHNwZWVkOjEwMDB9ICwge2lkOlwiTGV2ZWwgNFwiLCBsZW5ndGg6MTUsIHNwZWVkOjMwMH0gLCB7aWQ6XCJMZXZlbCA1XCIsIGxlbmd0aDozMCwgc3BlZWQ6NTB9LCB7aWQ6XCJMZXZlbCA2XCIsIGxlbmd0aDo0MCwgc3BlZWQ6MTB9XTtcclxuICAgIHRoaXMubGV2ZWxJbmRleCA9IDA7XHJcbiAgICB0aGlzLmxldmVsTG9hZGluZyA9IHRydWU7XHJcblxyXG4gICAgdGhpcy5iYWNrR3JvdW5kID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUoMCwwLCAnYmcnKTtcclxuXHJcbiAgICB0aGlzLmdhbWUudGltZS5hZHZhbmNlZFRpbWluZyA9IHRydWU7XHJcblxyXG4gICAgdGhpcy5lbmVteXNTb2xkaWVycyA9IFtdO1xyXG4gICAgdGhpcy5zb2xkaWVycyA9IFtdO1xyXG4gICAgdGhpcy5lbmVteVNvbGRpZXJzQ291bnQgPSAxMDtcclxuICAgIHRoaXMuc29sZGllcnNDb3VudCA9IDEwO1xyXG4gICAgdGhpcy5nYW1lb3ZlciA9IGZhbHNlO1xyXG4gICAgdGhpcy5nYW1lLmVuZW15S2lsbGVkID0gMDtcclxuXHJcbiAgICB0aGlzLnNvbGRpZXJzTGVmdFRleHQgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDAsIDYwLCAnbWluZWNyYWZ0aWEnLCB0aGlzLnNvbGRpZXJzQ291bnQudG9TdHJpbmcoKSApO1xyXG4gICAgdGhpcy5zb2xkaWVyc0xlZnRUZXh0LnggPSB0aGlzLmdhbWUud2lkdGggLSB0aGlzLnNvbGRpZXJzTGVmdFRleHQudGV4dFdpZHRoIC0gMjA7XHJcblxyXG4gICAgdGhpcy5jdXJyZW50TGV2ZWxUZXh0ID0gdGhpcy5hZGQuYml0bWFwVGV4dCgwLCAyMCwgJ21pbmVjcmFmdGlhJywgdGhpcy5jdXJyZW50TGV2ZWwoKS5pZCApO1xyXG4gICAgdGhpcy5jdXJyZW50TGV2ZWxUZXh0LnggPSB0aGlzLmdhbWUud2lkdGggLSB0aGlzLmN1cnJlbnRMZXZlbFRleHQudGV4dFdpZHRoIC0gMjA7XHJcblxyXG4gICAgLy8gQnVsbGV0c1xyXG4gICAgdGhpcy5maXJlUmF0ZSA9IDUwO1xyXG4gICAgdGhpcy5uZXh0RmlyZSA9IDEwO1xyXG5cclxuICAgIHRoaXMuYnVsbGV0cyA9IHRoaXMuZ2FtZS5hZGQuZ3JvdXAoKTtcclxuICAgIHRoaXMuYnVsbGV0cy5lbmFibGVCb2R5ID0gdHJ1ZTtcclxuICAgIHRoaXMuYnVsbGV0cy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XHJcblxyXG4gICAgdGhpcy5idWxsZXRzLmNyZWF0ZU11bHRpcGxlKDEwMCwgJ2J1bGxldCcpO1xyXG4gICAgdGhpcy5idWxsZXRzLnNldEFsbCgnY2hlY2tXb3JsZEJvdW5kcycsIHRydWUpO1xyXG4gICAgdGhpcy5idWxsZXRzLnNldEFsbCgnb3V0T2ZCb3VuZHNLaWxsJywgdHJ1ZSk7XHJcblxyXG4gICAgLy90aGlzLnR1cnJldEhvbGRlciA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHRoaXMuZ2FtZS53aWR0aCAvIDIsIHRoaXMuZ2FtZS5oZWlnaHQgLSA3NSwgJ3R1cnJldGhvbGRlcicpO1xyXG4gICAgXHJcbiAgICB0aGlzLnNwcml0ZSA9IHRoaXMuZ2FtZS5hZGQuc3ByaXRlKHRoaXMuZ2FtZS53aWR0aCAvIDIgLSAyMCwgdGhpcy5nYW1lLmhlaWdodCAtIDc1LCAndHVycmV0Jyk7XHJcbiAgICB0aGlzLnNwcml0ZS5zY2FsZS5zZXQoMC4yNSwwLjI1KTtcclxuICAgIHRoaXMuc3ByaXRlLmFuY2hvci5zZXQoMCwgMC41KTtcclxuICAgIHRoaXMuc3ByaXRlLnZpc2libGUgPSBmYWxzZTtcclxuXHJcbiAgICB0aGlzLmdhbWUucGh5c2ljcy5lbmFibGUodGhpcy5zcHJpdGUsIFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XHJcbiAgICB0aGlzLnNwcml0ZS5ib2R5LmFsbG93Um90YXRpb24gPSBmYWxzZTtcclxuXHJcbiAgICB0aGlzLmVuZW15VGltZXIgPSB0aGlzLmdhbWUudGltZS5jcmVhdGUoZmFsc2UpO1xyXG4gICAgdGhpcy5lbmVteVRpbWVyLmxvb3AodGhpcy5jdXJyZW50TGV2ZWwoKS5zcGVlZCwgdGhpcy5jcmVhdGVFbmVteSwgdGhpcyk7XHJcbiAgICB0aGlzLmVuZW15VGltZXIuc3RhcnQoKTtcclxuXHJcbiAgICAvLyBFbmVteSBhbmltYXRpb25zIFxyXG4gICAgdGhpcy5lbmVteUR5aW5nQW5pbWF0aW9ucyA9IHRoaXMuZ2FtZS5hZGQuZ3JvdXAoKTtcclxuXHJcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IDMwOyBpKyspXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGVuZW15RHlpbmdBbmltYXRpb24gPSB0aGlzLmVuZW15RHlpbmdBbmltYXRpb25zLmNyZWF0ZSgwLCAwLCAnZW5lbXlkeWluZycsIFswXSwgZmFsc2UpO1xyXG4gICAgICAgIGVuZW15RHlpbmdBbmltYXRpb24uYW5jaG9yLnNldFRvKDAsIC0wLjI1KTtcclxuICAgICAgICBlbmVteUR5aW5nQW5pbWF0aW9uLmFuaW1hdGlvbnMuYWRkKCdlbmVteWR5aW5nJyk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gY29uY2VudHJhdGVkRmlyZVxyXG4gICAgdGhpcy5leHBsb3Npb25zID0gdGhpcy5nYW1lLmFkZC5ncm91cCgpO1xyXG4gICAgLy90aGlzLmV4cGxvc2lvbnMuZW5hYmxlQm9keSA9IHRydWU7XHJcbiAgICAvL3RoaXMuZXhwbG9zaW9ucy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREU7XHJcbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IDEwOyBqKyspXHJcbiAgICB7XHJcbiAgICAgICAgdmFyIGV4cGxvc2lvbkFuaW1hdGlvbiA9IHRoaXMuZXhwbG9zaW9ucy5jcmVhdGUoMCwgMCwgJ3NtYWxsRXhwbG9zaW9uJywgWzBdLCBmYWxzZSk7XHJcbiAgICAgICAgZXhwbG9zaW9uQW5pbWF0aW9uLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcbiAgICAgICAgZXhwbG9zaW9uQW5pbWF0aW9uLmFuaW1hdGlvbnMuYWRkKCdzbWFsbEV4cGxvc2lvbicpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vdGhpcy5jb25jZW50cmF0ZWRGaXJlQnV0dG9uID0gdGhpcy5nYW1lLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuS2V5Ym9hcmQuU1BBQ0VCQVIpO1xyXG5cclxuICAgIC8vdGhpcy5lbWl0dGVyID0gdGhpcy5nYW1lLmFkZC5lbWl0dGVyKDAsIDAsIDEwMCk7XHJcbiAgICAvL3RoaXMuZW1pdHRlci5wYXJ0aWNsZUZyaWN0aW9uID0gMC4xO1xyXG5cclxuICB9LFxyXG5cclxuICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB0aGlzLmdhbWUuZGVidWcudGV4dCh0aGlzLmdhbWUudGltZS5mcHMgfHwgJy0tJywgMiwgMTQsICcjMDBmZjAwJyk7XHJcblxyXG4gICAgaWYodGhpcy5nYW1lb3Zlcikge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLyppZih0aGlzLmVuZW15c1NvbGRpZXJzLmxlbmd0aCA8IHRoaXMuZW5lbXlTb2xkaWVyc0NvdW50KXtcclxuICAgICAgdGhpcy5jcmVhdGVFbmVteSgpO1xyXG4gICAgfSovXHJcblxyXG4gICAgaWYoIXRoaXMuZW5lbXlzU29sZGllcnMpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGZvciAodmFyIGkgPSB0aGlzLmVuZW15c1NvbGRpZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgIHZhciBlbmVteSA9IHRoaXMuZW5lbXlzU29sZGllcnNbaV07XHJcblxyXG4gICAgICB0aGlzLmdhbWUucGh5c2ljcy5hcmNhZGUub3ZlcmxhcCh0aGlzLmJ1bGxldHMsIHRoaXMuZW5lbXlzU29sZGllcnNbaV0sIHRoaXMuYnVsbGV0SGl0RW5lbXksIG51bGwsIHRoaXMpO1xyXG4gICAgICBcclxuICAgICAgaWYoZW5lbXkueSA+PSB0aGlzLmdhbWUuaGVpZ2h0IC0gMTUwKSB7XHJcbiAgICAgICAgdGhpcy5zb2xkaWVyc0NvdW50IC09IDE7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5lbmVteXNTb2xkaWVycy5zcGxpY2UoaSwxKTtcclxuICAgICAgICB0aGlzLnNvbGRpZXJzTGVmdFRleHQuc2V0VGV4dCh0aGlzLnNvbGRpZXJzQ291bnQudG9TdHJpbmcoKSk7XHJcblxyXG4gICAgICAgIHZhciBleHBsb3Npb25nID0gdGhpcy5leHBsb3Npb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgICAgICBleHBsb3Npb25nLnJlc2V0KGVuZW15LngsIGVuZW15LnkpO1xyXG4gICAgICAgIGV4cGxvc2lvbmcucGxheSgnc21hbGxFeHBsb3Npb24nLCAzMCwgZmFsc2UsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgZW5lbXkuZGVzdHJveSgpO1xyXG5cclxuICAgICAgICBpZih0aGlzLnNvbGRpZXJzQ291bnQgPD0gMCl7XHJcbiAgICAgICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWVPdmVyJyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc3ByaXRlLnJvdGF0aW9uID0gdGhpcy5nYW1lLnBoeXNpY3MuYXJjYWRlLmFuZ2xlVG9Qb2ludGVyKHRoaXMuc3ByaXRlKTtcclxuICAgIGlmICh0aGlzLmdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci5pc0Rvd24pIHtcclxuICAgICAgdGhpcy5zcHJpdGUudmlzaWJsZSA9IHRydWU7XHJcbiAgICAgIHRoaXMuZmlyZSgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgIHRoaXMuc3ByaXRlLnZpc2libGUgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKmlmICh0aGlzLmNvbmNlbnRyYXRlZEZpcmVCdXR0b24uaXNEb3duKSB7XHJcbiAgICAgICB0aGlzLmNvbmNlbnRyYXRlZEZpcmUodGhpcy5nYW1lLmlucHV0LmFjdGl2ZVBvaW50ZXIueCAtIDEwMCx0aGlzLmdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci55IC0gMTAwKTtcclxuICAgIH0qL1xyXG5cclxuICB9LFxyXG5cclxuICBmaXJlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBpZiAodGhpcy5nYW1lLnRpbWUubm93ID4gdGhpcy5uZXh0RmlyZSAmJiB0aGlzLmJ1bGxldHMuY291bnREZWFkKCkgPiAwKVxyXG4gICAge1xyXG4gICAgICB0aGlzLm5leHRGaXJlID0gdGhpcy5nYW1lLnRpbWUubm93ICsgdGhpcy5maXJlUmF0ZTtcclxuICAgICAgdmFyIGJ1bGxldCA9IHRoaXMuYnVsbGV0cy5nZXRGaXJzdERlYWQoKTtcclxuICAgICAgYnVsbGV0LnJlc2V0KHRoaXMuc3ByaXRlLnggLSAyLCB0aGlzLnNwcml0ZS55IC0gNSk7XHJcbiAgICAgIGJ1bGxldC5yb3RhdGlvbiA9IHRoaXMuZ2FtZS5waHlzaWNzLmFyY2FkZS5tb3ZlVG9Qb2ludGVyKGJ1bGxldCwgMTUwMCwgdGhpcy5nYW1lLmlucHV0LmFjdGl2ZVBvaW50ZXIpO1xyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIGN1cnJlbnRMZXZlbDogZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHRoaXMubGV2ZWxzW3RoaXMubGV2ZWxJbmRleF07XHJcbiAgfSxcclxuXHJcbiAgbmV4dExldmVsOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxldmVsSW5kZXgrKztcclxuXHJcbiAgICBpZih0aGlzLmN1cnJlbnRMZXZlbCgpKSB7XHJcbiAgICAgIFxyXG4gICAgICAvL3RoaXMuZW5lbXlUaW1lci5kZWxheSA9IHRoaXMuY3VycmVudExldmVsKCkuc3BlZWQ7XHJcbiAgICAgIHRoaXMuZW5lbXlUaW1lci5kZXN0cm95KCk7XHJcbiAgICAgIHRoaXMuZW5lbXlUaW1lciA9IHRoaXMuZ2FtZS50aW1lLmNyZWF0ZShmYWxzZSk7XHJcbiAgICAgIHRoaXMuZW5lbXlUaW1lci5sb29wKHRoaXMuY3VycmVudExldmVsKCkuc3BlZWQsIHRoaXMuY3JlYXRlRW5lbXksIHRoaXMpO1xyXG4gICAgICB0aGlzLmVuZW15VGltZXIuc3RhcnQoKTtcclxuXHJcblxyXG4gICAgICB0aGlzLmN1cnJlbnRMZXZlbFRleHQuZGVzdHJveSgpO1xyXG4gICAgICB0aGlzLmN1cnJlbnRMZXZlbFRleHQgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KDAsIDIwLCAnbWluZWNyYWZ0aWEnLCB0aGlzLmN1cnJlbnRMZXZlbCgpLmlkICk7XHJcbiAgICAgIHRoaXMuY3VycmVudExldmVsVGV4dC54ID0gdGhpcy5nYW1lLndpZHRoIC0gdGhpcy5jdXJyZW50TGV2ZWxUZXh0LnRleHRXaWR0aCAtIDIwO1xyXG5cclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoJ0dhbWVPdmVyJyk7XHJcbiAgICB9ICAgIFxyXG4gIH0sXHJcblxyXG4gIGNvbmNlbnRyYXRlZEZpcmU6IGZ1bmN0aW9uICh4LHkpIHtcclxuICAgICAgICBmb3IgKHZhciBpID0gdGhpcy5leHBsb3Npb25zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICB2YXIgZXhwbG9zaW9uc0FuaW1hdGlvbiA9IHRoaXMuZXhwbG9zaW9ucy5nZXRBdChpKTtcclxuICAgICAgICAgIGV4cGxvc2lvbnNBbmltYXRpb24ucmVzZXQoeCArIE1hdGgucmFuZG9tKCkqMjAwLCB5ICsgTWF0aC5yYW5kb20oKSoyMDApO1xyXG4gICAgICAgICAgZXhwbG9zaW9uc0FuaW1hdGlvbi5wbGF5KCdzbWFsbEV4cGxvc2lvbicsIDMwLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKHZhciBqID0gdGhpcy5lbmVteXNTb2xkaWVycy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xyXG4gICAgICAgICAgdmFyIGVuZW15ID0gdGhpcy5lbmVteXNTb2xkaWVyc1tqXTtcclxuICAgICAgICAgICB0aGlzLmdhbWUucGh5c2ljcy5hcmNhZGUub3ZlcmxhcCh0aGlzLmV4cGxvc2lvbnMsIGVuZW15LCB0aGlzLmhpdEVuZW15LCBudWxsLCB0aGlzKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICB9LFxyXG5cclxuICBidWxsZXRIaXRFbmVteTogZnVuY3Rpb24gKGVuZW15LCBidWxsZXQpIHtcclxuXHJcbiAgICAgIC8qdGhpcy5lbWl0dGVyLm1ha2VQYXJ0aWNsZXMoJ2Jsb29kJyk7XHJcbiAgICAgIHZhciBibG9vZCA9IG5ldyBQaGFzZXIuUmVjdGFuZ2xlKDAsIDAsIDMwLCA1KTtcclxuICAgICAgdGhpcy5lbWl0dGVyLm1ha2VQYXJ0aWNsZXMoYmxvb2QpO1xyXG5cclxuICAgICAgdGhpcy5lbWl0dGVyLnJvdGF0aW9uID0gYnVsbGV0LnJvdGF0aW9uO1xyXG5cclxuICAgICAgdGhpcy5lbWl0dGVyLmdyYXZpdHkgPSAwO1xyXG4gICAgICB0aGlzLmVtaXR0ZXIubWF4Um90YXRpb24gPSAwO1xyXG4gICAgICB0aGlzLmVtaXR0ZXIubWluUm90YXRpb24gPSAwO1xyXG5cclxuICAgICAgdGhpcy5lbWl0dGVyLnNldEFscGhhKDEsIDAsIDYwMCk7XHJcblxyXG4gICAgICB2YXIgcDEgPSBuZXcgUGhhc2VyLlBvaW50ICgxLDApO1xyXG4gICAgICBwMS5yb3RhdGUoMCwwLGJ1bGxldC5yb3RhdGlvbiArIDAuNSk7XHJcbiAgICAgIHAxLnNldE1hZ25pdHVkZSgyMDApO1xyXG4gICAgICBcclxuICAgICAgdmFyIHAyID0gbmV3IFBoYXNlci5Qb2ludCAoMSwwKTtcclxuICAgICAgcDIucm90YXRlKDAsMCxidWxsZXQucm90YXRpb24gLSAwLjUpO1xyXG4gICAgICBwMi5zZXRNYWduaXR1ZGUoMjAwKTtcclxuXHJcbiAgICAgIHRoaXMuZW1pdHRlci5tYXhQYXJ0aWNsZVNwZWVkID0gcDE7XHJcbiAgICAgIHRoaXMuZW1pdHRlci5taW5QYXJ0aWNsZVNwZWVkID0gcDI7XHJcbiAgICAgIC8vdGhpcy5lbWl0dGVyLnJvdGF0aW9uID0gMDtcclxuICAgICAgdGhpcy5lbWl0dGVyLnggPSBlbmVteS54ICsgMzA7XHJcbiAgICAgIHRoaXMuZW1pdHRlci55ID0gZW5lbXkueSArIDM1O1xyXG5cclxuICAgICAgdGhpcy5lbWl0dGVyLnN0YXJ0KHRydWUsIDYwMCwgbnVsbCwgMTApOyovXHJcbiAgICAgIGJ1bGxldC5raWxsKCk7XHJcblxyXG4gICAgICBmb3IgKHZhciBpID0gdGhpcy5lbmVteXNTb2xkaWVycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgIGlmKGVuZW15ID09PSB0aGlzLmVuZW15c1NvbGRpZXJzW2ldKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgIGVuZW15LmhpdCgpO1xyXG5cclxuICAgICAgICAgIGlmKGVuZW15LmhpdFBvaW50cyA9PT0gMCkge1xyXG4gICAgICAgICAgICB0aGlzLmVuZW15c1NvbGRpZXJzLnNwbGljZShpLDEpO1xyXG5cclxuICAgICAgICAgICAgdmFyIGVuZW15RHlpbmdBbmltYXRpb24gPSB0aGlzLmVuZW15RHlpbmdBbmltYXRpb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgICAgICAgICAgZW5lbXlEeWluZ0FuaW1hdGlvbi5yZXNldChlbmVteS54LCBlbmVteS55KTtcclxuICAgICAgICAgICAgZW5lbXlEeWluZ0FuaW1hdGlvbi5hbHBoYSA9IDE7XHJcbiAgICAgICAgICAgIGVuZW15RHlpbmdBbmltYXRpb24ucGxheSgnZW5lbXlkeWluZycsIDMwLCBmYWxzZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUudGltZS5ldmVudHMuYWRkKFBoYXNlci5UaW1lci5TRUNPTkQgKiAxLCB0aGlzLmZhZGVBbmltYXRpb24sIHRoaXMsIGVuZW15RHlpbmdBbmltYXRpb24pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgaWYoZW5lbXkuaGl0UG9pbnRzID09PSAwKSB7XHJcbiAgICAgICAgZW5lbXkua2lsbCgpO1xyXG4gICAgICAgIHRoaXMuZ2FtZS5lbmVteUtpbGxlZCsrO1xyXG5cclxuICAgICAgICBpZih0aGlzLmdhbWUuZW5lbXlLaWxsZWQgPj0gdGhpcy5jdXJyZW50TGV2ZWwoKS5sZW5ndGgpe1xyXG4gICAgICAgICAgdGhpcy5uZXh0TGV2ZWwoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vdmFyIGRlc3Ryb3llZCA9IGVuZW1pZXNbdGFuay5uYW1lXS5kYW1hZ2UoKTtcclxuXHJcbiAgICAgIC8qaWYgKGRlc3Ryb3llZClcclxuICAgICAge1xyXG4gICAgICAgICAgdmFyIGV4cGxvc2lvbkFuaW1hdGlvbiA9IGV4cGxvc2lvbnMuZ2V0Rmlyc3RFeGlzdHMoZmFsc2UpO1xyXG4gICAgICAgICAgZXhwbG9zaW9uQW5pbWF0aW9uLnJlc2V0KHRhbmsueCwgdGFuay55KTtcclxuICAgICAgICAgIGV4cGxvc2lvbkFuaW1hdGlvbi5wbGF5KCdrYWJvb20nLCAzMCwgZmFsc2UsIHRydWUpO1xyXG4gICAgICB9Ki9cclxuICB9LFxyXG5cclxuICBmYWRlQW5pbWF0aW9uOiBmdW5jdGlvbiAoYW5pbWF0aW9uKSB7XHJcbiAgICAvL2NvbnNvbGUubG9nKFwiLS0tLS1cIik7XHJcbiAgICAvL2NvbnNvbGUubG9nKGFuaW1hdGlvbik7XHJcbiAgICB2YXIgZmFkZUFuaW0gPSB0aGlzLmdhbWUuYWRkLnR3ZWVuKGFuaW1hdGlvbikudG8oIHsgYWxwaGE6IDAgfSwgMTAwMCwgUGhhc2VyLkVhc2luZy5MaW5lYXIuTm9uZSwgdHJ1ZSk7XHJcbiAgICBmYWRlQW5pbS5vbkNvbXBsZXRlLmFkZChmdW5jdGlvbiAoKSB7IHRoaXMucmVtb3ZlVHdlZW4oYW5pbWF0aW9uKTsgfSwgdGhpcyk7XHJcblxyXG4gIH0sXHJcblxyXG4gIGhpdEVuZW15OiBmdW5jdGlvbiAoZW5lbXkpIHtcclxuICAgIGZvciAodmFyIGkgPSB0aGlzLmVuZW15c1NvbGRpZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgIGlmKGVuZW15ID09PSB0aGlzLmVuZW15c1NvbGRpZXJzW2ldKVxyXG4gICAgICB7XHJcbiAgICAgICAgdGhpcy5lbmVteXNTb2xkaWVycy5zcGxpY2UoaSwxKTtcclxuXHJcbiAgICAgICAgdmFyIGVuZW15RHlpbmdBbmltYXRpb24gPSB0aGlzLmVuZW15RHlpbmdBbmltYXRpb25zLmdldEZpcnN0RXhpc3RzKGZhbHNlKTtcclxuICAgICAgICBlbmVteUR5aW5nQW5pbWF0aW9uLnJlc2V0KGVuZW15LngsIGVuZW15LnkpO1xyXG4gICAgICAgIGVuZW15RHlpbmdBbmltYXRpb24ucGxheSgnZW5lbXlkeWluZycsIDMwLCBmYWxzZSwgZmFsc2UpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBlbmVteS5raWxsKCk7XHJcbiAgfSxcclxuXHJcbiAgcmVtb3ZlVHdlZW46IGZ1bmN0aW9uIChhbmltYXRpb24pIHtcclxuICAgIGFuaW1hdGlvbi5raWxsKCk7XHJcbiAgfSxcclxuICBraWxsQW5pbWF0aW9uOiBmdW5jdGlvbiAoYW5pbWF0aW9uKSB7XHJcbiAgICAvL2NvbnNvbGUubG9nKFwidGhpcy5lbmVteUR5aW5nQW5pbWF0aW9uc1wiKTtcclxuICAgIC8vY29uc29sZS5sb2codGhpcy5lbmVteUR5aW5nQW5pbWF0aW9ucyk7XHJcbiAgfSxcclxuXHJcbiAgY2hlY2tPdmVybGFwRW5lbXlYOiBmdW5jdGlvbiAoKSB7XHJcbiAgICBcclxuICAgIFxyXG5cclxuICB9LFxyXG5cclxuICBjcmVhdGVFbmVteTogZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBlbmVteVggPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAodGhpcy5nYW1lLndpZHRoIC0gNjUpKTtcclxuXHJcbiAgICAvKnZhciBwYXNzID0gdHJ1ZTtcclxuICAgIGZvciAodmFyIGkgPSB0aGlzLmVuZW15c1NvbGRpZXJzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgIHZhciBzb2xkaWVyID0gdGhpcy5lbmVteXNTb2xkaWVyc1tpXTtcclxuXHJcbiAgICAgIGlmKGVuZW15WCA8IHNvbGRpZXIueCArIDY1ICYmIGVuZW15WCA+IHNvbGRpZXIueCAtIDY1ICkge1xyXG4gICAgICAgIHBhc3MgPSBmYWxzZTtcclxuICAgICAgfVxyXG5cclxuICAgIH0qL1xyXG5cclxuICAgIC8qaWYoIXBhc3Mpe1xyXG4gICAgICB0aGlzLmNyZWF0ZUVuZW15KCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH0qL1xyXG5cclxuICAgIHZhciBlbmVteSA9IG5ldyBFbmVteSh0aGlzLmdhbWUsIGVuZW15WCwgMCk7XHJcbiAgICB0aGlzLmdhbWUucGh5c2ljcy5lbmFibGUoZW5lbXksIFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XHJcbiAgICB0aGlzLmVuZW15c1NvbGRpZXJzLnB1c2goZW5lbXkpO1xyXG4gICAgXHJcbiAgfSxcclxuXHJcbiAgY2hlY2tPdmVybGFwOiBmdW5jdGlvbiAoc3ByaXRlQSwgc3ByaXRlQikge1xyXG4gICAgdmFyIGJvdW5kc0EgPSBzcHJpdGVBLmdldEJvdW5kcygpO1xyXG4gICAgdmFyIGJvdW5kc0IgPSBzcHJpdGVCLmdldEJvdW5kcygpO1xyXG5cclxuICAgIHJldHVybiBQaGFzZXIuUmVjdGFuZ2xlLmludGVyc2VjdHMoYm91bmRzQSwgYm91bmRzQik7XHJcbiAgfSxcclxuXHJcbiAgZW5kR2FtZTogZnVuY3Rpb24gKCkge1xyXG4gICAgXHJcbiAgfSxcclxuXHJcbiAgb25JbnB1dERvd246IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xyXG4gIH1cclxufTtcclxuIiwidmFyIEdhbWVvdmVyID0gZnVuY3Rpb24gKCkge307XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWVvdmVyO1xyXG5cclxuR2FtZW92ZXIucHJvdG90eXBlID0ge1xyXG5cclxuICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciB4ID0gdGhpcy5nYW1lLndpZHRoIC8gMlxyXG4gICAgICAsIHkgPSB0aGlzLmdhbWUuaGVpZ2h0IC8gMjtcclxuXHJcbiAgICB0aGlzLnRpdGxlVHh0ID0gdGhpcy5hZGQuYml0bWFwVGV4dCh4LCB5LCAnbWluZWNyYWZ0aWEnLCAnS2lsbGVkOiAnICsgdGhpcy5nYW1lLmVuZW15S2lsbGVkICk7XHJcbiAgICB0aGlzLnRpdGxlVHh0LmFsaWduID0gJ2NlbnRlcic7XHJcbiAgICB0aGlzLnRpdGxlVHh0LnggPSB0aGlzLmdhbWUud2lkdGggLyAyIC0gdGhpcy50aXRsZVR4dC50ZXh0V2lkdGggLyAyO1xyXG5cclxuICAgIC8veSA9IHkgKyB0aGlzLnRpdGxlVHh0LmhlaWdodCArIDU7XHJcbiAgICB0aGlzLnN0YXJ0VHh0ID0gdGhpcy5hZGQuYml0bWFwVGV4dCh4LCB5ICsgNTAsICdtaW5lY3JhZnRpYScsICdHQU1FIE9WRVInKTtcclxuICAgIHRoaXMuc3RhcnRUeHQuYWxpZ24gPSAnY2VudGVyJztcclxuICAgIHRoaXMuc3RhcnRUeHQueCA9IHRoaXMuZ2FtZS53aWR0aCAvIDIgLSB0aGlzLnN0YXJ0VHh0LnRleHRXaWR0aCAvIDI7XHJcbiAgICBcclxuICAgIHRoaXMuaW5wdXQub25Eb3duLmFkZCh0aGlzLm9uRG93biwgdGhpcyk7XHJcbiAgfSxcclxuXHJcbiAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XHJcblxyXG4gIH0sXHJcblxyXG4gIG9uRG93bjogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XHJcbiAgICAvL3RoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZW92ZXInKTtcclxuICB9XHJcbn07XHJcbiIsInZhciBNZW51ID0gZnVuY3Rpb24gKCkge1xyXG4gIHRoaXMudGV4dCA9IG51bGw7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IE1lbnU7XHJcblxyXG5NZW51LnByb3RvdHlwZSA9IHtcclxuXHJcbiAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgeCA9IHRoaXMuZ2FtZS53aWR0aCAvIDJcclxuICAgICAgLCB5ID0gdGhpcy5nYW1lLmhlaWdodCAvIDI7XHJcblxyXG4gICAgXHJcbiAgICB0aGlzLmxvZ29UZXh0ID0gdGhpcy5hZGQuYml0bWFwVGV4dCh4LCB5IC0gMjAwLCAnbWluZWNyYWZ0aWEnLCAnTFNHJywgMTY0ICk7XHJcbiAgICB0aGlzLmxvZ29UZXh0LmFsaWduID0gJ2NlbnRlcic7XHJcbiAgICB0aGlzLmxvZ29UZXh0LnggPSB0aGlzLmdhbWUud2lkdGggLyAyIC0gdGhpcy5sb2dvVGV4dC50ZXh0V2lkdGggLyAyO1xyXG5cclxuICAgIHRoaXMuZGVzY2lwdGlvblR4dCA9IHRoaXMuYWRkLmJpdG1hcFRleHQoeCwgeSArIDEwLCAnbWluZWNyYWZ0aWEnLCAnTElUVExFIFNISVRUWSBHQU1FUycsIDI3ICk7XHJcbiAgICB0aGlzLmRlc2NpcHRpb25UeHQuYWxpZ24gPSAnY2VudGVyJztcclxuICAgIHRoaXMuZGVzY2lwdGlvblR4dC54ID0gdGhpcy5nYW1lLndpZHRoIC8gMiAtIHRoaXMuZGVzY2lwdGlvblR4dC50ZXh0V2lkdGggLyAyO1xyXG5cclxuICAgIHRoaXMudGl0bGVUeHQgPSB0aGlzLmFkZC5iaXRtYXBUZXh0KHgsIHkgKyAxMDAsICdtaW5lY3JhZnRpYScsICdOYWFwdXJpbmthdWh1JyApO1xyXG4gICAgdGhpcy50aXRsZVR4dC5hbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgdGhpcy50aXRsZVR4dC54ID0gdGhpcy5nYW1lLndpZHRoIC8gMiAtIHRoaXMudGl0bGVUeHQudGV4dFdpZHRoIC8gMjtcclxuXHJcbiAgICB0aGlzLnN0YXJ0VHh0ID0gdGhpcy5hZGQuYml0bWFwVGV4dCh4LCB0aGlzLmdhbWUuaGVpZ2h0IC0gdGhpcy50aXRsZVR4dC5oZWlnaHQgLSAxNSwgJ21pbmVjcmFmdGlhJywgJ1ByZXNzIHNjcmVlbiB0byBzdGFydCcpO1xyXG4gICAgdGhpcy5zdGFydFR4dC5hbGlnbiA9ICdjZW50ZXInO1xyXG4gICAgdGhpcy5zdGFydFR4dC54ID0gdGhpcy5nYW1lLndpZHRoIC8gMiAtIHRoaXMuc3RhcnRUeHQudGV4dFdpZHRoIC8gMjtcclxuXHJcbiAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG5cclxuICB9LFxyXG5cclxuICBvbkRvd246IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnR2FtZScpO1xyXG4gICAgLy90aGlzLmdhbWUuc2NhbGUuc3RhcnRGdWxsU2NyZWVuKCk7XHJcbiAgfVxyXG59O1xyXG4iLCJ2YXIgUHJlbG9hZGVyID0gZnVuY3Rpb24gKGdhbWUpIHtcclxuICB0aGlzLmFzc2V0ID0gbnVsbDtcclxuICB0aGlzLnJlYWR5ID0gZmFsc2U7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFByZWxvYWRlcjtcclxuXHJcblByZWxvYWRlci5wcm90b3R5cGUgPSB7XHJcblxyXG4gIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgdGhpcy5hc3NldCA9IHRoaXMuYWRkLnNwcml0ZSh0aGlzLmdhbWUud2lkdGggLyAyLCB0aGlzLmdhbWUuaGVpZ2h0IC8gMiwgJ3ByZWxvYWRlcicpO1xyXG4gICAgICB0aGlzLmFzc2V0LmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XHJcblxyXG4gICAgICB0aGlzLmxvYWQub25Mb2FkQ29tcGxldGUuYWRkT25jZSh0aGlzLm9uTG9hZENvbXBsZXRlLCB0aGlzKTtcclxuICAgICAgdGhpcy5sb2FkLnNldFByZWxvYWRTcHJpdGUodGhpcy5hc3NldCk7XHJcbiAgICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgna2Fib29tJywgJ2Fzc2V0cy9leHBsb3Npb24ucG5nJywgNjQsIDY0LCAyMyk7XHJcbiAgICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnYmlnRXhwbG9zaW9uJywgJ2Fzc2V0cy9iaWctZXhwbG9zaW9uLnBuZycsIDI1NiwgMTI4LCAxMik7XHJcbiAgICAgIHRoaXMubG9hZC5zcHJpdGVzaGVldCgnc21hbGxFeHBsb3Npb24nLCAnYXNzZXRzL3NtYWxsLWV4cGxvc2lvbi5wbmcnLCA5NiwgOTYsIDQ4KTtcclxuICAgICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdlbmVteWR5aW5nJywgJ2Fzc2V0cy9lbmVteWR5aW5nLnBuZycsIDYzLCA2NCwgMjApO1xyXG4gICAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2VuZW15U3ByaXRlJywgJ2Fzc2V0cy9lbmVteS5wbmcnLCA2NCwgNjQsIDE1KTtcclxuICAgICAgdGhpcy5sb2FkLmltYWdlKCdiZycsICdhc3NldHMvYmcucG5nJyk7XHJcbiAgICAgIHRoaXMubG9hZC5pbWFnZSgnYmxvb2QnLCAnYXNzZXRzL2Jsb29kLmpwZycpO1xyXG4gICAgICB0aGlzLmxvYWQuaW1hZ2UoJ2VhcnRoJywgJ2Fzc2V0cy9lYXJ0aC5wbmcnKTtcclxuICAgICAgdGhpcy5sb2FkLmltYWdlKCdlbmVteScsICdhc3NldHMvaW52YWRlci5wbmcnKTtcclxuICAgICAgdGhpcy5sb2FkLmltYWdlKCd0dXJyZXQnLCAnYXNzZXRzL3R1cnJldC5wbmcnKTtcclxuICAgICAgdGhpcy5sb2FkLmltYWdlKCd0dXJyZXRob2xkZXInLCAnYXNzZXRzL2d1bi1ob2xkZXIucG5nJyk7XHJcbiAgICAgIHRoaXMubG9hZC5pbWFnZSgnYnVsbGV0JywgJ2Fzc2V0cy9idWxsZXQucG5nJyk7XHJcbiAgICAgIHRoaXMubG9hZC5iaXRtYXBGb250KCdtaW5lY3JhZnRpYScsICdhc3NldHMvbWluZWNyYWZ0aWEucG5nJywgJ2Fzc2V0cy9taW5lY3JhZnRpYS54bWwnKTtcclxuICAgICAgdGhpcy5sb2FkLmF1ZGlvKCdzZngnLCAnYXNzZXRzL2F1ZGlvL1NvdW5kRWZmZWN0cy9meF9taXhkb3duLm9nZycpO1xyXG4gIH0sXHJcblxyXG4gIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgdGhpcy5hc3NldC5jcm9wRW5hYmxlZCA9IGZhbHNlO1xyXG4gIH0sXHJcblxyXG4gIHVwZGF0ZTogZnVuY3Rpb24gKCkge1xyXG4gICAgaWYgKCEhdGhpcy5yZWFkeSkge1xyXG4gICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xyXG4gICAgICB9XHJcbiAgfSxcclxuXHJcbiAgb25Mb2FkQ29tcGxldGU6IGZ1bmN0aW9uICgpIHtcclxuICAgIHRoaXMucmVhZHkgPSB0cnVlO1xyXG4gIH1cclxufTtcclxuIiwidmFyIFV0aWxzID0ge1xyXG4gICAgY29udGFpbnNPYmplY3Q6IGZ1bmN0aW9uKG9iaiwgbGlzdCkge1xyXG4gICAgICAgIHZhciBpO1xyXG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmIChsaXN0W2ldID09PSBvYmopIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFV0aWxzOyJdfQ==
